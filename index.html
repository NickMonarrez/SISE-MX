function validar() {
    const user = document.getElementById('user').value;
    const pass = document.getElementById('pass').value;
    // ASEGÚRATE DE QUE ESTA URL TERMINE EN /exec
    const urlScript = "https://script.google.com/macros/s/AKfycbyuDk9I7rhobSEGdcW_6bBbb6yrWjTEVcUZxsVZu5aZjZHy9CjDh_hs_l4YZdSLOXy_IA/exec";

    // Usamos 'no-cors' no es ideal, mejor dejarlo que gestione el redireccionamiento
    fetch(`${urlScript}?accion=login&usuario=${encodeURIComponent(user)}&pass=${encodeURIComponent(pass)}`, {
        method: 'GET'
    })
    .then(res => {
        // Google a veces redirige, esto ayuda a manejar la respuesta
        return res.json();
      })
    .then(data => {
        if(data.success) {
            alert("¡Bienvenido al sistema!");
            // Aquí puedes redirigir a otra página si quieres
        } else {
            alert("Usuario o contraseña incorrectos");
        }
    })
    .catch(err => {
        console.error(err);
        alert("Error de conexión: Verifica que tu Script esté publicado como 'Nueva Versión'");
    });
}
